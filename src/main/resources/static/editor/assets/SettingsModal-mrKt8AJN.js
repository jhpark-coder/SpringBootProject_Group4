import{j as e}from"./index-C6BaCfYk.js";import{r as i}from"./tiptap-vendor-C2mi-KzI.js";import"./react-vendor-DeqkGhWy.js";import"./icons-vendor-8W8gD9qm.js";import"./utils-vendor-JBSp_YRO.js";const h={아트워크:["포토그라피","일러스트레이션","스케치","코믹스"],그래픽디자인:["타이포그라피","뮤직패키징","로고","그래픽디자인스","편집"],캐릭터:["카툰","애니메","팬아트","3D"],Java:["통신","알고리즘","Thread","etc"],프론트엔드:["HTML","CSS","Javascript","etc"],Python:["통신","알고리즘","Thread","etc"]},G=["1일","3일","7일"],X=({isOpen:v,onClose:w,onSave:F,initialSettings:o})=>{const[t,g]=i.useState(o||{}),[d,b]=i.useState(""),[l,P]=i.useState(""),[x,j]=i.useState(""),[C,N]=i.useState(""),[p,f]=i.useState(""),[m,y]=i.useState(""),[D,T]=i.useState(""),[H,E]=i.useState(""),[r,n]=i.useState({}),k=i.useRef(null);i.useEffect(()=>{v&&o&&(g(o),b(o.primaryCategory||""),P(o.saleType||""),j(o.salePrice||""),N(o.auctionDuration||""),f(o.startBidPrice||""),y(o.buyNowPrice||""),T(o.workDescription||""),E(o.buyout_price||""))},[v,o]),i.useEffect(()=>{const s=Object.keys(h).find(a=>t.tags.includes(a));s&&b(s)},[t.tags]),i.useEffect(()=>{console.log("SettingsModal 초기화 - settings:",t),t.saleType&&P(t.saleType),t.salePrice&&j(t.salePrice),t.auctionDuration&&N(t.auctionDuration),t.startBidPrice&&f(t.startBidPrice),t.buyNowPrice&&y(t.buyNowPrice)},[t]);const I=()=>{var c;const s={};(c=t.title)!=null&&c.trim()||(s.title="프로젝트 제목은 필수입니다."),d||(s.primaryCategory="1차 카테고리를 선택해주세요.");const a=t.tags.some(u=>{var B;return d&&((B=h[d])==null?void 0:B.includes(u))});return a||(s.secondaryCategory="세부 카테고리를 선택해주세요."),a&&!l&&(s.saleType="판매 방식을 선택해주세요."),l==="sale"&&(!x||parseFloat(x)<=0)&&(s.salePrice="희망판매가를 입력해주세요."),l==="auction"&&(C||(s.auctionDuration="경매 기간을 선택해주세요."),(!p||parseFloat(p)<=0)&&(s.startBidPrice="시작입찰가를 입력해주세요."),(!m||parseFloat(m)<=0)&&(s.buyNowPrice="즉시입찰가를 입력해주세요."),p&&m&&parseFloat(m)<=parseFloat(p)&&(s.buyNowPrice="즉시입찰가는 시작입찰가보다 높아야 합니다.")),n(s),Object.keys(s).length===0},R=s=>{g(a=>({...a,title:s.target.value})),r.title&&n(a=>({...a,title:""}))},A=s=>{const a=s.target.files[0];if(a){const c=new FileReader;c.onloadend=()=>{g(u=>({...u,coverImage:c.result}))},c.readAsDataURL(a)}},O=s=>{b(s),g(a=>({...a,tags:[s]})),r.primaryCategory&&n(a=>({...a,primaryCategory:""}))},$=s=>{const a=t.tags.filter(u=>!Object.keys(h).includes(u)),c=a.indexOf(s);c>-1?a.splice(c,1):a.push(s),g(u=>({...u,tags:[d,...a]})),r.secondaryCategory&&n(u=>({...u,secondaryCategory:""}))},S=s=>{P(s),s==="sale"?(N(""),f(""),y("")):s==="auction"&&j(""),r.saleType&&n(a=>({...a,saleType:""}))},_=s=>{const a=s.target.value;j(a),r.salePrice&&n(c=>({...c,salePrice:""}))},L=s=>{N(s),r.auctionDuration&&n(a=>({...a,auctionDuration:""}))},M=s=>{const a=s.target.value;f(a),a&&m&&parseFloat(a)>parseFloat(m)&&y(""),r.startBidPrice&&n(c=>({...c,startBidPrice:""})),r.buyNowPrice&&n(c=>({...c,buyNowPrice:""}))},U=s=>{const a=s.target.value;y(a),r.buyNowPrice&&n(c=>({...c,buyNowPrice:""}))},J=s=>{T(s.target.value)},W=()=>{if(I()){const s={...t,saleType:l,salePrice:l==="sale"?x:"",auctionDuration:l==="auction"?C:"",startBidPrice:l==="auction"?p:"",buyNowPrice:l==="auction"?m:"",workDescription:D};F(s)}};return t.tags.some(s=>{var a;return d&&((a=h[d])==null?void 0:a.includes(s))}),v?e.jsx("div",{className:"modal-overlay",onClick:w,children:e.jsxs("div",{className:"settings-modal-content",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"settings-modal-header",children:e.jsx("h2",{children:"Settings"})}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"settings-grid",children:[e.jsxs("div",{className:"left-column",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"프로젝트 표지"}),e.jsxs("div",{className:"cover-image-container",children:[t.coverImage?e.jsxs("div",{className:"image-wrapper",onClick:()=>k.current.click(),children:[e.jsx("img",{src:t.coverImage,alt:"프로젝트 표지",className:"main-image"}),e.jsx("div",{className:"image-overlay",children:e.jsx("button",{className:"overlay-button",children:"이미지 변경"})})]}):e.jsxs("div",{className:"cover-image-placeholder",onClick:()=>k.current.click(),children:[e.jsx("span",{children:"+"}),e.jsx("p",{children:"클릭하여 표지 이미지 추가"})]}),e.jsx("input",{type:"file",ref:k,onChange:A,accept:"image/*",style:{display:"none"}})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"work-description",children:"작품 설명"}),e.jsx("textarea",{id:"work-description",value:D,onChange:J,placeholder:"작품에 대한 간단한 설명을 입력해주세요. (200자 이내)",maxLength:"200",className:"form-textarea"})]})]}),e.jsxs("div",{className:"right-column",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"project-title",children:"프로젝트 제목 (필수)"}),e.jsx("input",{type:"text",id:"project-title",value:t.title,onChange:R,placeholder:"프로젝트의 제목을 입력하세요",className:r.title?"error":""}),r.title&&e.jsx("span",{className:"error-message",children:r.title})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"1차 카테고리"}),e.jsx("div",{className:"category-group primary-categories",children:Object.keys(h).map(s=>e.jsx("button",{className:`category-button ${d===s?"active":""}`,onClick:()=>O(s),children:s},s))}),r.primaryCategory&&e.jsx("span",{className:"error-message",children:r.primaryCategory}),d&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"세부 카테고리"}),e.jsx("div",{className:"category-group secondary-categories",children:h[d].map(s=>e.jsx("button",{className:`category-button ${t.tags.includes(s)?"active":""}`,onClick:()=>$(s),children:s},s))}),r.secondaryCategory&&e.jsx("span",{className:"error-message",children:r.secondaryCategory})]})]}),t.tags&&t.tags.length>1&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"판매 방식"}),e.jsxs("div",{className:"sale-type-group",children:[e.jsx("button",{className:`sale-type-button ${l==="sale"?"active":""}`,onClick:()=>S("sale"),children:"판매"}),e.jsx("button",{className:`sale-type-button ${l==="auction"?"active":""}`,onClick:()=>S("auction"),children:"경매"})]}),r.saleType&&e.jsx("span",{className:"error-message",children:r.saleType})]}),l==="sale"&&e.jsxs("div",{className:"price-input-section",children:[e.jsx("label",{htmlFor:"sale-price",children:"희망판매가 (원)"}),e.jsx("input",{type:"number",id:"sale-price",value:x,onChange:_,placeholder:"희망판매가를 입력하세요",min:"0",className:r.salePrice?"error":""}),r.salePrice&&e.jsx("span",{className:"error-message",children:r.salePrice})]}),l==="auction"&&e.jsxs("div",{className:"auction-settings",children:[e.jsxs("div",{className:"auction-duration-section",children:[e.jsx("label",{children:"경매 기간"}),e.jsx("div",{className:"duration-group",children:G.map(s=>e.jsx("button",{className:`duration-button ${C===s?"active":""}`,onClick:()=>L(s),children:s},s))}),r.auctionDuration&&e.jsx("span",{className:"error-message",children:r.auctionDuration})]}),e.jsxs("div",{className:"price-input-section",children:[e.jsx("label",{htmlFor:"start-bid-price",children:"시작입찰가 (원)"}),e.jsx("input",{type:"number",id:"start-bid-price",value:p,onChange:M,placeholder:"시작입찰가를 입력하세요",min:"0",className:r.startBidPrice?"error":""}),r.startBidPrice&&e.jsx("span",{className:"error-message",children:r.startBidPrice})]}),e.jsxs("div",{className:"price-input-section",children:[e.jsx("label",{htmlFor:"buy-now-price",children:"즉시입찰가 (원)"}),e.jsx("input",{type:"number",id:"buy-now-price",value:m,onChange:U,placeholder:"즉시입찰가는 시작입찰가보다 높아야 합니다.",min:"0",className:r.buyNowPrice?"error":""}),r.buyNowPrice&&e.jsx("span",{className:"error-message",children:r.buyNowPrice})]})]})]})]})}),e.jsxs("div",{className:"settings-modal-footer",children:[e.jsx("button",{onClick:W,className:"save-button",children:"저장"}),e.jsx("button",{onClick:w,className:"cancel-button",children:"취소"})]})]})}):null};export{X as default};
