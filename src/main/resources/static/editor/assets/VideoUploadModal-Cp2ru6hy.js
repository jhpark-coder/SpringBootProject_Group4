import{j as e}from"./index-C6BaCfYk.js";import{r as n}from"./tiptap-vendor-C2mi-KzI.js";import"./react-vendor-DeqkGhWy.js";import"./icons-vendor-8W8gD9qm.js";import"./utils-vendor-JBSp_YRO.js";const T=({onClose:i,onVideoAdd:h})=>{const[c,y]=n.useState(""),[f,d]=n.useState(!1),[R,r]=n.useState(0);n.useRef(null);const[a,v]=n.useState(null),[x,g]=n.useState(""),b=()=>{if(!c){alert("Please enter a video URL.");return}h({src:c}),i()},j=async o=>{const t=o.target.files[0];if(!t)return;const u=100*1024*1024;if(t.size>u){alert("비디오 파일 크기는 100MB를 초과할 수 없습니다.");return}if(!t.type.startsWith("video/")){alert("비디오 파일만 업로드 가능합니다.");return}d(!0),r(0);try{const p=new FormData;p.append("file",t);const l=new XMLHttpRequest;l.upload.addEventListener("progress",s=>{if(s.lengthComputable){const m=Math.round(s.loaded/s.total*100);r(m)}}),l.addEventListener("load",()=>{if(l.status===200)try{console.log("Raw response:",l.responseText),console.log("Response type:",typeof l.responseText),console.log("Response length:",l.responseText.length);const s=l.responseText;if(console.log("Video URL:",s),console.log("Video URL type:",typeof s),console.log("Video URL length:",s.length),s&&s.trim()!==""&&s!=="[]"){console.log("Calling onVideoAdd with:",{src:s});const m=`http://localhost:8080${s}`;console.log("Full video URL:",m),h({src:m}),i()}else console.error("Empty or invalid response from server:",s),alert("비디오 업로드 중 오류가 발생했습니다. 서버에서 유효한 URL을 반환하지 않았습니다.")}catch(s){console.error("응답 파싱 오류:",s),console.error("Response text:",l.responseText),alert("비디오 업로드 중 오류가 발생했습니다.")}else console.error("업로드 실패:",l.status,l.responseText),alert("비디오 업로드에 실패했습니다.");d(!1),r(0)}),l.addEventListener("error",()=>{console.error("업로드 오류"),alert("비디오 업로드 중 오류가 발생했습니다."),d(!1),r(0)}),l.open("POST","/editor/api/upload"),l.send(p)}catch(p){console.error("파일 처리 오류:",p),alert("비디오 처리 중 오류가 발생했습니다."),d(!1),r(0)}},N=o=>{const t=o.target.files[0];if(!t)return;const u=100*1024*1024;if(t.size>u){alert("비디오 파일 크기는 100MB를 초과할 수 없습니다.");return}if(!t.type.startsWith("video/")){alert("비디오 파일만 업로드 가능합니다.");return}v(t),g("")},U=()=>{if(!a){g("Please select a video file.");return}j({target:{files:[a]}})};return e.jsx("div",{className:"modal-overlay fancy-modal-overlay",onClick:i,children:e.jsxs("div",{className:"modal-content fancy-modal-content animate-fadeIn",onClick:o=>o.stopPropagation(),children:[e.jsx("h2",{className:"fancy-modal-title",children:"비디오 업로드"}),e.jsxs("div",{className:"modal-section",style:{marginBottom:"1.2rem"},children:[e.jsx("label",{className:"fancy-label",children:"URL로 비디오 추가"}),e.jsxs("div",{className:"fancy-url-input-group",children:[e.jsx("input",{type:"url",placeholder:"https://example.com/video.mp4",value:c,onChange:o=>y(o.target.value),className:"fancy-input"}),e.jsx("button",{onClick:b,className:"fancy-embed-btn",disabled:!c,children:"추가"})]})]}),e.jsxs("div",{className:"modal-section",children:[e.jsx("label",{className:"fancy-label",children:"파일 업로드"}),e.jsxs("div",{className:"fancy-file-upload-group",style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx("input",{type:"file",accept:"video/*",id:"video-upload-input",style:{display:"none"},onChange:N}),e.jsx("label",{htmlFor:"video-upload-input",className:"fancy-embed-btn fancy-file-btn",children:"파일 선택"}),a&&e.jsx("span",{className:"fancy-file-name",children:a.name})]})]}),x&&e.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 rounded",children:x}),a&&e.jsxs("div",{className:"mb-4 p-2 bg-gray-100 rounded",children:[e.jsxs("p",{children:["선택된 파일: ",a.name]}),e.jsxs("p",{children:["크기: ",(a.size/1024/1024).toFixed(2)," MB"]})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{onClick:U,className:"fancy-embed-btn",disabled:!a||f,children:f?"업로드 중...":"업로드"}),e.jsx("button",{onClick:i,className:"fancy-embed-btn",disabled:f,children:"취소"})]})]})})};export{T as default};
