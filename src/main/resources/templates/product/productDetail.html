<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{fragment/layout}">

<head>
    <meta charset="UTF-8">
    <meta name="_csrf" th:content="${_csrf != null ? _csrf.token : ''}"/>
    <meta name="_csrf_header" th:content="${_csrf != null ? _csrf.headerName : ''}"/>
    <title th:text="${product.name} + ' - Nexus'">Artwork Page</title>
    <style>
    /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ ë° í°íŠ¸ */
    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }
    body {
        font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', Arial, sans-serif;
        background: #fff;
        color: #222;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
    }
    a { text-decoration: none; color: inherit; }
    button { cursor: pointer; border: none; font-family: inherit; }

    /* --- í—¤ë” --- */
    .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 60px;
        height: 80px;
        border-bottom: 1px solid #e0e0e0;
        background: #fff;
        position: relative;
    }
    .header .logo {
        width: 50px;
        height: 50px;
        background: #e0f2ff;
        border-radius: 8px;
        flex-shrink: 0;
        margin-left: 400px;
    }
    .header nav {
        position: absolute;
        left: 600px;
        right: 0;
        margin: auto;
        width: fit-content;
        top: 0; bottom: 0;
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .header nav ul {
        display: flex;
        gap: 48px;
        list-style: none;
        font-size: 17px;
        font-weight: bold;
    }
    .header .user-info {
        margin-left: auto;
    }
    .header .points-btn {
        background: #007bff;
        color: #fff;
        padding: 8px 18px;
        border-radius: 20px;
        font-size: 15px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    /* --- ì¹´í…Œê³ ë¦¬ ë°” --- */
    .category-bar {
        background: #007bff;
        padding: 14px 0;
        display: flex;
        justify-content: center;
        gap: 18px;
    }
    .category-bar .category-btn {
        background: #fff;
        color: #007bff;
        padding: 8px 32px;
        border-radius: 20px;
        font-size: 15px;
        font-weight: 500;
        border: none;
        box-shadow: 0 1px 2px rgba(0,0,0,0.07);
        transition: background 0.2s;
    }
    .category-bar .category-btn:hover {
        background: #e6f0ff;
    }

    /* --- ë©”ì¸ ì»¨í…ì¸  --- */
    .main-content {
        flex: 1;
        display: flex;
        justify-content: center;
        gap: 40px;
        max-width: 1200px;
        margin: 0 auto;
        padding: 40px 0 0 0;
    }
    .artwork-section {
        flex: 2;
        display: flex;
        flex-direction: column;
        gap: 24px;
    }
    .artwork-section h1 {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 18px;
    }
    .artwork-image {
        width: 100%;
        max-width: 700px;
        aspect-ratio: 4/3;
        background: #d9d9d9;
        border-radius: 8px;
        object-fit: cover;
        display: block;
        margin-bottom: 0;
    }

    /* --- ì‚¬ì´ë“œë°” --- */
    .sidebar {
        flex: 1;
        border: 1px solid #e0e0e0;
        border-radius: 12px;
        padding: 22px 20px;
        height: fit-content;
        display: flex;
        flex-direction: column;
        gap: 18px;
        background: #fff;
        box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        min-width: 270px;
        max-width: 320px;
    }
    .sidebar .author-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .sidebar .author-profile {
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .sidebar .author-pfp {
        width: 40px;
        height: 40px;
        background: #e0e0e0;
        border-radius: 50%;
    }
    .sidebar .author-name {
        font-weight: bold;
        font-size: 15px;
    }
    .sidebar .subscribe-btn {
        background: #007bff;
        color: #fff;
        padding: 7px 16px;
        border-radius: 5px;
        font-size: 14px;
        font-weight: 500;
    }
    .sidebar .follow-btn {
        background: #007bff;
        color: black;
        padding: 7px 16px;
        border-radius: 5px;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.3s ease;
    }
    .sidebar .follow-btn.following {
        background: #6c757d;
        color: #fff;
    }
    .sidebar .follow-btn:hover {
        opacity: 0.8;
    }
    .sidebar .tags {
        display: flex;
        gap: 8px;
    }
    .sidebar .tag-btn {
        background: #f0f0f0;
        border: 1px solid #ddd;
        border-radius: 15px;
        padding: 5px 12px;
        font-size: 12px;
        color: #555;
    }
    .sidebar .description {
        font-size: 14px;
        color: #555;
        line-height: 1.6;
    }
    .sidebar .continue-btn {
        background: #ffc107;
        color: #333;
        width: 100%;
        padding: 12px 0;
        font-size: 16px;
        font-weight: bold;
        border-radius: 8px;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
        margin-top: 8px;
    }

    /* --- í‘¸í„° --- */
    .footer {
        background: #007bff;
        color: #fff;
        padding: 38px 0 24px 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        margin-top: auto;
    }
    .footer .footer-logo {
        width: 60px;
        height: 60px;
        background: #d9d9d9;
        border-radius: 8px;
    }
    .footer .sitename {
        font-size: 14px;
        margin-top: 5px;
    }
    .footer .copyright {
        font-size: 12px;
        color: #cce5ff;
        margin-top: 2px;
    }

    /* ì¢‹ì•„ìš” ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .sidebar-actions {
        display: flex;
        flex-direction: column;
        gap: 12px;
        margin-top: 16px;
    }
    
    .like-btn, .wishlist-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        background: #f8f9fa;
        color: #6c757d;
        border: 1px solid #dee2e6;
        padding: 10px 16px;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.3s ease;
        cursor: pointer;
    }
    
    .like-btn:hover, .wishlist-btn:hover {
        background: #e9ecef;
        border-color: #adb5bd;
    }
    
    .like-btn.liked {
        background: #dc3545;
        color: white;
        border-color: #dc3545;
    }
    
    .like-btn.liked:hover {
        background: #c82333;
        border-color: #bd2130;
    }
    
    .wishlist-btn.wished {
        background: #ff6b6b;
        color: white;
        border-color: #ff6b6b;
    }
    
    .wishlist-btn.wished:hover {
        background: #ff5252;
        border-color: #ff4757;
    }
    
    .like-icon, .wishlist-icon {
        font-size: 16px;
    }
    
    .like-count, .wishlist-count {
        font-weight: 600;
    }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="logo"></div>
        <nav>
            <ul>
                <li><a href="#">ê³ ê°ì„¼í„°</a></li>
                <li><a href="#">ì‘í’ˆê²½ë§¤</a></li>
                <li><a href="/wishlist">ì°œí•œ ìƒí’ˆ</a></li>
                <li><a href="#">ë§ˆì´í˜ì´ì§€</a></li>
            </ul>
        </nav>
        <div class="user-info">
            <button class="points-btn">
                <span>ë³´ìœ í•œ í¬ì¸íŠ¸: 1000</span>
                <span style="font-size: 18px;">ğŸ””</span>
            </button>
        </div>
    </header>

    <!-- Category Bar -->
    <div class="category-bar">
        <button class="category-btn">ì•„íŠ¸ì›</button>
        <button class="category-btn">ê·¸ë˜í”½ë””ìì¸</button>
        <button class="category-btn">ìºë¦­í„°</button>
        <button class="category-btn">Java</button>
        <button class="category-btn">í”„ë¡ íŠ¸ì—”ë“œ</button>
        <button class="category-btn">Python</button>
    </div>

    <!-- Main Content -->
    <main class="main-content" layout:fragment="content">
        <section class="artwork-section">
            <h1 th:text="${product.name}">ë‚˜ëŠ” ì´ ì‘í’ˆì˜ ì—„ì²­ë‚œ ì´ë¦„ì´ì‹œë‹¤.</h1>
            <img th:src="${product.imageUrl}" 
                 src="https://via.placeholder.com/800x600" 
                 alt="Artwork Image" 
                 class="artwork-image"
                 onerror="this.src='https://via.placeholder.com/800x600/cccccc/666666?text=ì´ë¯¸ì§€ë¥¼+ë¶ˆëŸ¬ì˜¬+ìˆ˜+ì—†ìŠµë‹ˆë‹¤'">
            <div class="description-section" th:utext="${product.description}">
                <p>ì—¬ê¸°ì— TipTap ì—ë””í„°ë¡œ ì‘ì„±ëœ ìƒì„¸í•œ ìƒí’ˆ ì„¤ëª…ì´ ë“¤ì–´ê°‘ë‹ˆë‹¤.</p>
            </div>
        </section>

        <aside class="sidebar">
            <div class="author-info">
                <div class="author-profile">
                    <img src="https://via.placeholder.com/40" 
                         alt="ì‘ê°€ í”„ë¡œí•„" 
                         class="author-pfp"
                         onerror="this.src='https://via.placeholder.com/40/cccccc/666666?text=ì‘ê°€'"/>
                    <span class="author-name" th:text="${product.creatorName ?: 'ìµëª… ì‘ê°€'}">ì‘ê°€ì´ë¦„ì´ ë“¤ì–´ê°€</span>
                </div>
                <button th:if="${#authentication.name != null and product.creator != null and #authentication.name != product.creator.username}" 
                        class="follow-btn" 
                        th:data-creator-id="${product.creator.id}"
                        onclick="toggleFollow(this)">
                    íŒ”ë¡œìš°
                </button>
            </div>
            <div class="tags">
                <button class="tag-btn" th:text="${product.primaryCategory != null and product.primaryCategory != '' ? product.primaryCategory : 'ì•„íŠ¸ì›'}">ì•„íŠ¸ì›</button>
                <button class="tag-btn" th:text="${product.secondaryCategory != null and product.secondaryCategory != '' ? product.secondaryCategory : 'í¬í† ê·¸ë˜í”¼'}">í¬í† ê·¸ë˜í”¼</button>
            </div>
            <p class="description">
                ë³´ì´ì‹œê² ì§€ë§Œ ì´ê³³ì€ ì„¤ëª…ì„ ë„£ëŠ” ê³³ ì…ë‹ˆë‹¤. ë‹¹ì—°í•˜ê²Œë„ ì„¤ëª…ë€ì…ë‹ˆë‹¤. ì°¸ìœ¼ë¡œ ë‹¤ì–‘í•œ ë°ì´í„°ë¥¼ ì ì„ ìˆ˜ ìˆëŠ” ì´ê³³ì€ ì„¤ëª…ë€ì…ë‹ˆë‹¤.
            </p>
            <div class="sidebar-actions">
                <button class="like-btn" th:data-product-id="${product.id}" 
                        th:classappend="${isLiked ? 'liked' : ''}"
                        onclick="toggleLike(this)">
                    <span class="like-icon">ğŸ‘</span>
                    <span class="like-count" th:text="${heartCount ?: 0}">0</span>
                </button>
                <button class="wishlist-btn" th:data-product-id="${product.id}" 
                        th:classappend="${isWished ? 'wished' : ''}"
                        onclick="toggleWishlist(this)">
                    <span class="wishlist-icon">â¤ï¸</span>
                    <span class="wishlist-count" th:text="${wishCount ?: 0}">0</span>
                </button>
                <button class="continue-btn" onclick="alert('í¬ì¸íŠ¸ ê²°ì œ ê¸°ëŠ¥ ì¶”ê°€ ì˜ˆì •!')">
                    <span>30Pë¡œ ê³„ì†ë³´ê¸°</span>
                </button>
            </div>
        </aside>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-logo"></div>
        <p class="sitename">SiteName</p>
        <p class="copyright">2025 Copyright 4ì¡° í”„ë¡œì íŠ¸</p>
    </footer>

    <script>
    // íŒ”ë¡œìš° í† ê¸€ í•¨ìˆ˜
    function toggleFollow(button) {
        console.log('íŒ”ë¡œìš° ë²„íŠ¼ í´ë¦­ë¨');
        
        const creatorId = button.dataset.creatorId;
        if (!creatorId) {
            alert('ì‘ê°€ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            return;
        }

        const csrfTokenMeta = document.querySelector('meta[name="_csrf"]');
        const csrfHeaderMeta = document.querySelector('meta[name="_csrf_header"]');
        
        const headers = {
            'Content-Type': 'application/json'
        };
        
        if (csrfTokenMeta && csrfHeaderMeta && csrfTokenMeta.getAttribute('content') && csrfHeaderMeta.getAttribute('content')) {
            headers[csrfHeaderMeta.getAttribute('content')] = csrfTokenMeta.getAttribute('content');
        }

        // Optimistic UI: ë¨¼ì € UIë¥¼ ì¦‰ì‹œ ë³€ê²½
        const isFollowing = button.classList.contains('following');
        if (isFollowing) {
            button.classList.remove('following');
            button.textContent = 'íŒ”ë¡œìš°';
        } else {
            button.classList.add('following');
            button.textContent = 'íŒ”ë¡œì‰';
        }

        // API í˜¸ì¶œ
        fetch(`/api/follow/${creatorId}`, {
            method: 'POST',
            headers: headers
        })
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                // ì˜¤ë¥˜ ë°œìƒ ì‹œ UI ë˜ëŒë¦¬ê¸°
                if (isFollowing) {
                    button.classList.add('following');
                    button.textContent = 'íŒ”ë¡œì‰';
                } else {
                    button.classList.remove('following');
                    button.textContent = 'íŒ”ë¡œìš°';
                }
                alert(data.message);
            } else {
                console.log('íŒ”ë¡œìš° ìƒíƒœ ë³€ê²½ë¨:', data);
            }
        })
        .catch(error => {
            console.error('íŒ”ë¡œìš° ìš”ì²­ ì‹¤íŒ¨:', error);
            // ì˜¤ë¥˜ ë°œìƒ ì‹œ UI ë˜ëŒë¦¬ê¸°
            if (isFollowing) {
                button.classList.add('following');
                button.textContent = 'íŒ”ë¡œì‰';
            } else {
                button.classList.remove('following');
                button.textContent = 'íŒ”ë¡œìš°';
            }
            alert('íŒ”ë¡œìš° ìš”ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        });
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ íŒ”ë¡œìš° ìƒíƒœ í™•ì¸
    document.addEventListener('DOMContentLoaded', function() {
        const followBtn = document.querySelector('.follow-btn');
        if (followBtn) {
            const creatorId = followBtn.dataset.creatorId;
            if (creatorId) {
                // íŒ”ë¡œìš° ìƒíƒœ í™•ì¸
                fetch(`/api/follow/${creatorId}/status`)
                .then(response => response.json())
                .then(data => {
                    if (data.isFollowing) {
                        followBtn.classList.add('following');
                        followBtn.textContent = 'íŒ”ë¡œì‰';
                    }
                })
                .catch(error => {
                    console.error('íŒ”ë¡œìš° ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);
                });
            }
        }

        // ì¢‹ì•„ìš” ìƒíƒœ í™•ì¸
        const likeBtn = document.querySelector('.like-btn');
        if (likeBtn) {
            const productId = likeBtn.dataset.productId;
            if (productId) {
                // ì¢‹ì•„ìš” ìƒíƒœ í™•ì¸
                fetch(`/api/products/${productId}/heart/status`)
                .then(response => response.json())
                .then(data => {
                    if (data.isLiked) {
                        likeBtn.classList.add('liked');
                    }
                    // ì„œë²„ì—ì„œ ë°›ì€ ì •í™•í•œ ì¢‹ì•„ìš” ìˆ˜ë¡œ ì—…ë°ì´íŠ¸
                    const likeCountSpan = likeBtn.querySelector('.like-count');
                    if (likeCountSpan) {
                        likeCountSpan.textContent = data.heartCount;
                    }
                })
                .catch(error => {
                    console.error('ì¢‹ì•„ìš” ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);
                });
            }
        }

        // ì°œí•˜ê¸° ìƒíƒœ í™•ì¸
        const wishlistBtn = document.querySelector('.wishlist-btn');
        if (wishlistBtn) {
            const productId = wishlistBtn.dataset.productId;
            if (productId) {
                // ì°œí•˜ê¸° ìƒíƒœ í™•ì¸
                fetch(`/wishlist/check/${productId}`)
                .then(response => response.json())
                .then(data => {
                    if (data.isWished) {
                        wishlistBtn.classList.add('wished');
                    }
                    // ì„œë²„ì—ì„œ ë°›ì€ ì •í™•í•œ ì°œí•˜ê¸° ìˆ˜ë¡œ ì—…ë°ì´íŠ¸
                    const wishlistCountSpan = wishlistBtn.querySelector('.wishlist-count');
                    if (wishlistCountSpan) {
                        wishlistCountSpan.textContent = data.wishCount;
                    }
                })
                .catch(error => {
                    console.error('ì°œí•˜ê¸° ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);
                });
            }
        }
    });

    function toggleLike(button) {
        console.log('ì¢‹ì•„ìš” ë²„íŠ¼ í´ë¦­ë¨');
        
        const productId = button.dataset.productId;
        if (!productId) {
            alert('ìƒí’ˆ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            return;
        }
        
        const csrfTokenMeta = document.querySelector('meta[name="_csrf"]');
        const csrfHeaderMeta = document.querySelector('meta[name="_csrf_header"]');
        
        // CSRF í† í°ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ í—¤ë”ì— ì¶”ê°€
        const headers = {
            'Content-Type': 'application/json'
        };
        
        if (csrfTokenMeta && csrfHeaderMeta && csrfTokenMeta.getAttribute('content') && csrfHeaderMeta.getAttribute('content')) {
            headers[csrfHeaderMeta.getAttribute('content')] = csrfTokenMeta.getAttribute('content');
            console.log('CSRF í† í° ì¶”ê°€ë¨:', csrfTokenMeta.getAttribute('content'));
        } else {
            console.log('CSRF í† í° ì—†ìŒ (ê°œë°œ í™˜ê²½)');
        }

        const likeCountSpan = button.querySelector('.like-count');
        let currentCount = parseInt(likeCountSpan.textContent, 10);
        const isLiked = button.classList.contains('liked');

        // Optimistic UI: ë¨¼ì € UIë¥¼ ì¦‰ì‹œ ë³€ê²½
        if (isLiked) {
            likeCountSpan.textContent = Math.max(currentCount - 1, 0);
            button.classList.remove('liked');
        } else {
            likeCountSpan.textContent = currentCount + 1;
            button.classList.add('liked');
        }

        // API í˜¸ì¶œ
        fetch(`/api/products/${productId}/heart`, {
            method: 'POST',
            headers: headers
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            if (data.error) {
                // ì˜¤ë¥˜ ë°œìƒ ì‹œ UI ë˜ëŒë¦¬ê¸°
                if (isLiked) {
                    likeCountSpan.textContent = currentCount;
                    button.classList.add('liked');
                } else {
                    likeCountSpan.textContent = Math.max(currentCount - 1, 0);
                    button.classList.remove('liked');
                }
                alert(data.message);
            } else {
                // ì„±ê³µ ì‹œ ì„œë²„ì—ì„œ ë°›ì€ ì •í™•í•œ ê°’ìœ¼ë¡œ ì—…ë°ì´íŠ¸
                likeCountSpan.textContent = data.heartCount;
                if (data.isLiked) {
                    button.classList.add('liked');
                } else {
                    button.classList.remove('liked');
                }
                console.log('ì¢‹ì•„ìš” ìƒíƒœ ë³€ê²½ë¨:', data);
            }
        })
        .catch(error => {
            console.error('ì¢‹ì•„ìš” ìš”ì²­ ì‹¤íŒ¨:', error);
            // ì˜¤ë¥˜ ë°œìƒ ì‹œ UI ë˜ëŒë¦¬ê¸°
            if (isLiked) {
                likeCountSpan.textContent = currentCount;
                button.classList.add('liked');
            } else {
                likeCountSpan.textContent = Math.max(currentCount - 1, 0);
                button.classList.remove('liked');
            }
            alert('ì¢‹ì•„ìš” ìš”ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        });
    }

    // ì°œí•˜ê¸° í† ê¸€ í•¨ìˆ˜
    function toggleWishlist(button) {
        console.log('ì°œí•˜ê¸° ë²„íŠ¼ í´ë¦­ë¨');
        
        const productId = button.dataset.productId;
        if (!productId) {
            alert('ìƒí’ˆ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            return;
        }
        
        const csrfTokenMeta = document.querySelector('meta[name="_csrf"]');
        const csrfHeaderMeta = document.querySelector('meta[name="_csrf_header"]');
        
        // CSRF í† í°ì´ ìˆëŠ” ê²½ìš°ì—ë§Œ í—¤ë”ì— ì¶”ê°€
        const headers = {
            'Content-Type': 'application/json'
        };
        
        if (csrfTokenMeta && csrfHeaderMeta && csrfTokenMeta.getAttribute('content') && csrfHeaderMeta.getAttribute('content')) {
            headers[csrfHeaderMeta.getAttribute('content')] = csrfTokenMeta.getAttribute('content');
            console.log('CSRF í† í° ì¶”ê°€ë¨:', csrfTokenMeta.getAttribute('content'));
        } else {
            console.log('CSRF í† í° ì—†ìŒ (ê°œë°œ í™˜ê²½)');
        }

        const wishlistCountSpan = button.querySelector('.wishlist-count');
        let currentCount = parseInt(wishlistCountSpan.textContent, 10);
        const isWished = button.classList.contains('wished');

        // Optimistic UI: ë¨¼ì € UIë¥¼ ì¦‰ì‹œ ë³€ê²½
        if (isWished) {
            wishlistCountSpan.textContent = Math.max(currentCount - 1, 0);
            button.classList.remove('wished');
        } else {
            wishlistCountSpan.textContent = currentCount + 1;
            button.classList.add('wished');
        }

        // API í˜¸ì¶œ
        fetch(`/wishlist/toggle/${productId}`, {
            method: 'POST',
            headers: headers
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            if (data.success) {
                // ì„±ê³µ ì‹œ ì„œë²„ì—ì„œ ë°›ì€ ì •í™•í•œ ê°’ìœ¼ë¡œ ì—…ë°ì´íŠ¸
                wishlistCountSpan.textContent = data.wishCount;
                if (data.isWished) {
                    button.classList.add('wished');
                } else {
                    button.classList.remove('wished');
                }
                console.log('ì°œí•˜ê¸° ìƒíƒœ ë³€ê²½ë¨:', data);
            } else {
                // ì˜¤ë¥˜ ë°œìƒ ì‹œ UI ë˜ëŒë¦¬ê¸°
                if (isWished) {
                    wishlistCountSpan.textContent = currentCount;
                    button.classList.add('wished');
                } else {
                    wishlistCountSpan.textContent = Math.max(currentCount - 1, 0);
                    button.classList.remove('wished');
                }
                alert(data.message);
            }
        })
        .catch(error => {
            console.error('ì°œí•˜ê¸° ìš”ì²­ ì‹¤íŒ¨:', error);
            // ì˜¤ë¥˜ ë°œìƒ ì‹œ UI ë˜ëŒë¦¬ê¸°
            if (isWished) {
                wishlistCountSpan.textContent = currentCount;
                button.classList.add('wished');
            } else {
                wishlistCountSpan.textContent = Math.max(currentCount - 1, 0);
                button.classList.remove('wished');
            }
            alert('ì°œí•˜ê¸° ìš”ì²­ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
        });
    }
    </script>
</body>
</html>
